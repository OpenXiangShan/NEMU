/***************************************************************************************
 * Copyright (c) 2025 Institute of Computing Technology, Chinese Academy of
 *Sciences
 *
 * NEMU is licensed under Mulan PSL v2.
 * You can use this software according to the terms and conditions of the Mulan
 *PSL v2. You may obtain a copy of Mulan PSL v2 at:
 *          http://license.coscl.org.cn/MulanPSL2
 *
 * THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY
 *KIND, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO
 *NON-INFRINGEMENT, MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.
 *
 * See the Mulan PSL v2 for more details.
 ***************************************************************************************/

#ifdef CONFIG_CUSTOM_TENSOR

#include "register.h"

def_DHelper(rvt_3r1w) {
  decode_op_i(s, id_src1, s->isa.instr.tensor_compute_64.rs1, true);
  decode_op_i(s, id_src2, s->isa.instr.tensor_compute_64.rs2, true);
  decode_op_i(s, id_src3, s->isa.instr.tensor_compute_64.rs3, true);
}
def_DHelper(rvt_2r1w) {
  decode_op_i(s, id_src1, s->isa.instr.tensor_cfg_xchg_64.rs1, true);
  decode_op_i(s, id_src3, s->isa.instr.tensor_cfg_xchg_64.rs3, true);
  decode_op_i(s, id_dest, s->isa.instr.tensor_cfg_xchg_64.rd, true);
}
def_DHelper(rvt_1r1w) {
  decode_op_i(s, id_src3, s->isa.instr.tensor_cfg_imm_64.rs3, true);
  decode_op_i(s, id_dest, s->isa.instr.tensor_cfg_imm_64.rd, true);
}

def_THelper(rvt_3r1w_dispatch) {
  def_INSTR_TAB(
      "00000000????????????????????????????????????????????????????????",
      tx_matmul_subfloat);
  def_INSTR_TAB(
      "00000001????????????????????????????????????????????????????????",
      tx_matmul_float);
  def_INSTR_TAB(
      "00000010????????????????????????????????????????????????????????",
      tx_matmul_fix);
  def_INSTR_TAB(
      "00000101????????????????????????????????????????????????????????",
      tx_conv);
  def_INSTR_TAB(
      "00001000????????????????????????????????????????????????????????",
      tx_int);
  def_INSTR_TAB(
      "00001001????????????????????????????????????????????????????????",
      tx_fp);
  def_INSTR_TAB(
      "00001010????????????????????????????????????????????????????????",
      tx_lut_int);
  def_INSTR_TAB(
      "00001011????????????????????????????????????????????????????????",
      tx_lut_fp);
  return EXEC_ID_inv;
}

def_THelper(rvt_2r1w_dispatch) {
  def_INSTR_TAB(
      "10000010????????????????????????????????????????????????????????",
      tx_pooling);
  def_INSTR_TAB(
      "10000000????????????????????????????????????????????????????????",
      tx_tcsr_xchg_nmask);
  def_INSTR_TAB(
      "10000001????????????????????????????????????????????????????????",
      tx_tcsr_xchg_mask);
  def_INSTR_TAB(
      "10000100????????????????????????????????????????????????????????",
      tx_async_uram_copy);
  def_INSTR_TAB(
      "10000110????????????????????????????????????????????????????????",
      tx_async_uram_load);
  def_INSTR_TAB(
      "10000101????????????????????????????????????????????????????????",
      tx_async_uram_store);
  def_INSTR_TAB(
      "10001000????????????????????????????????????????????????????????",
      tx_sync_uram_copy);
  def_INSTR_TAB(
      "10001010????????????????????????????????????????????????????????",
      tx_sync_uram_load);
  def_INSTR_TAB(
      "10001001????????????????????????????????????????????????????????",
      tx_sync_uram_store);
  def_INSTR_TAB(
      "10001100????????????????????????????????????????????????????????",
      tx_int_reduce);
  def_INSTR_TAB(
      "10001101????????????????????????????????????????????????????????",
      tx_fp_reduce);
  def_INSTR_TAB(
      "10010000????????????????????????????????????????????????????????",
      tx_sfu);
  def_INSTR_TAB(
      "10001110????????????????????????????????????????????????????????",
      tx_convert);
  return EXEC_ID_inv;
}

def_THelper(rvt_1r1w_dispatch) {
  def_INSTR_TAB(
      "11000000????????????????????????????????????????????????????????",
      tx_tcsr_imm_nmask);
  def_INSTR_TAB(
      "11000001????????????????????????????????????????????????????????",
      tx_tcsr_imm_mask);
  return EXEC_ID_inv;
}

#endif /* CONFIG_CUSTOM_TENSOR */
